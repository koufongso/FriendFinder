<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--boostrap-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!--jQuery-->
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>

    <title>Survey</title>
</head>

<body>
    <div class="container">
        <form method="POST">
            <div class="form-body">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" class="form-control" id="name" placeholder="Please enter your name ..." required>
                </div>
                <br>
                <h3>Please answer the following questions on the scale of 1 - 5 (1 is lowest, 5 is highest)</h3>
                <br>
            </div>

            <button class="btn btn-primary" type="submit" id="form-submit">Submit form</button>
        </form>

    </div>


    <script>
        // design the questions here
        var questionList = ["How much do you enjoy playing sport?",
            "How much do you enjoy hiking?",
            "How much do you enjoy coking?",
            "How much do you enjoy watching movies?",
            "How much do you enjoy listening music?",
            "How much do you enjoy reading?",
            "How much do you enjoy playing video games?",
            "How much do you like pets?",
            "Are you an outgoing person?",
            "Do you like social media?"];
        for (var i = 0; i < questionList.length; i++) {
            var template = `<div class="form-group question">
                <label>${i + 1}.${questionList[i]}</label>
                <div class="form-control" style="border:none">
                    <div class="form-check form-check-inline col-1">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions${i + 1}" id="inlineRadio1"
                            value="1">
                        <label class="form-check-label" for="inlineRadio1">1</label>
                    </div>
                    <div class="form-check form-check-inline col-1">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions${i + 1}" id="inlineRadio2"
                            value="2">
                        <label class="form-check-label" for="inlineRadio2">2</label>
                    </div>
                    <div class="form-check form-check-inline col-1">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions${i + 1}" id="inlineRadio3"
                            value="3">
                        <label class="form-check-label" for="inlineRadio3">3</label>
                    </div>
                    <div class="form-check form-check-inline col-1">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions${i + 1}" id="inlineRadio4"
                            value="4">
                        <label class="form-check-label" for="inlineRadio3">4</label>
                    </div>
                    <div class="form-check form-check-inline col-1">
                        <input class="form-check-input" type="radio" name="inlineRadioOptions${i + 1}" id="inlineRadio5"
                            value="5">
                        <label class="form-check-label" for="inlineRadio5">5</label>
                    </div>
                </div>
            </div>`
            $(".form-body").append(template);
        }

        // submit 
        $("#form-submit").on("click", function (event) {
            event.preventDefault();
            var inputs = $("form .question .form-control input:checked");
            if($("#name").val()===""){
                alert("Please enter your name.")
            }else if (inputs.length != questionList) {
                alert("Please answer all the questions before submission.");
            } else {
                var scores = [];
                for (var i = 0; i < inputs.length; i++) {
                    scores.push(parseInt(inputs[i].value));
                }
                var newData = {
                    "name": $("#name").val().trim(),
                    "photo": "",
                    "scores": scores
                }

                // console.log(JSON.stringify(data));
                $.post("/api/friends", newData, function (data, status) {
                    console.log(status);
                    if (status === 200) {
                        alert("Success! Your information is in the database now.");
                    } else {
                        alert("Opps, it seems something is wrong. Please try again later.");
                    }

                    // clear
                    $("#name").val("");
                });
            }

        });


    </script>

</html>